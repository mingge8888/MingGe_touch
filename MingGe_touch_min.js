/* 
 *  MingGe_touch 触摸插件
 *  
 *  采用MingGejs开发 2017/2/14
 *
 *  作者：明哥先生-QQ399195513 QQ群：17939681   官网：www.shearphoto.com
 */
!function(a,b){var c=b(a),d=function(a){if(a&&a[0]){var b=a[0].getBoundingClientRect();return[b.left+c.scrollLeft(),b.top+c.scrollTop()]}},e=function(a){var b,c,d,e,f,g,h,i=a.touches,j=a.button,k=typeof j,l="number"==k;return i&&!l?(b=i.length,b>0&&(c=i[0],d=c.clientX,e=c.clientY,b>1&&(f=i[1],g=f.clientX,h=f.clientY)),{X:d,Y:e,X2:g,Y2:h,touchLen:b,dev:"mob"}):l&&2>j?{X:a.clientX,Y:a.clientY,touchLen:1,dev:"pc"}:!1},f=function(){for(var a,c=arguments.length,d=0;c>d;d++)if(a=arguments[d],!b.isUndefined(a))return a},g=function(){a.selection&&a.selection.empty?a.selection.empty():window.getSelection().removeAllRanges()},h=function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},i=function(){pcLOCK=!1},j=function(a,b){var j,l,n,o,p,q,r,s,t,u,v,w,x,y,z=!0,A=!1,B=!1,C=b.pc,D=(b.mob,b.isClick),E={stop:function(){z=!0,a.unbind(this.touchstart),c.unbind(this.touchmove),c.unbind(this.touchend),delete this.touchstart,delete this.touchmove,delete this.touchend,delete this.stop},pause:function(){B?B=!1:(z=B=!0,A=!1)},touchstart:function(c){var f,g;if(!B){if(h(c),D||c.preventDefault(),f=e(c),!f)return A=!0,void 0;if(C)if("pc"==f.dev){if(A)return}else D&&(A=!0);j=f.X,l=f.Y,n=f.X2,o=f.Y2,z=!1,a[0].setCapture&&a[0].setCapture(),g=d(a),p=g[0],q=g[1],r=j-p,s=l-q,b.down&&b.down.call(a,c,F,{X:j,Y:l,X2:n,Y2:o,disL:r,disT:s,touchLen:f.touchLen,dev:f.dev})}},touchmove:function(c){var d,f;return z||(h(c),c.preventDefault(),d=e(c),C&&A&&"pc"==d.dev)?void 0:(f=k(b.container),x=d.X-r-b.offsetLeft-f[0],y=d.Y-s-b.offsetTop-f[1],t=d.X,u=d.Y,v=d.X2,w=d.Y2,"pc"==d.dev&&g(),b.over&&b.over.call(a,c,F,{X:t,Y:u,downX:j,downY:l,X2:v,Y2:w,downX2:n,downY2:o,left:x,top:y,disL:r,disT:s,touchLen:d.touchLen,dev:d.dev}),!1)},touchend:function(c){if(!z){h(c),a[0].releaseCapture&&a[0].releaseCapture(),z=!0;var d=e(c);if(C)if("pc"==d.dev){if(A)return}else D&&setTimeout(i,350);d.X=f(d.X,t,j),d.Y=f(d.Y,u,l),d.X2=f(d.X2,v,n),d.Y2=f(d.Y2,w,o),b.up&&b.up.call(a,c,F,{X:d.X,Y:d.Y,X2:d.X2,Y2:d.Y2,downX:j,downY:l,downX2:n,downY2:o,disL:r,disT:s,left:x,top:y,dev:d.dev})}}},F=new m(E);return E},k=function(a){return d(a)||[0,0]},l=function(a,b){for(var c,d=a.length,e=0;d>e;e++)c=a[e],c[b]&&c[b]()},m=function(a){this._OBJ_=b.isArray(a)?a:[a]};m.prototype={stop:function(){l(this._OBJ_,"stop")},pause:function(){l(this._OBJ_,"pause")}},b.fn.extend({touch:function(a){var d,e;return a=b.extend({down:0,up:0,container:null,offsetLeft:0,pc:!0,mobile:!0,offsetTop:0,isClick:!0,over:0},a),b.isFunction(a.over)||(a.over=0),b.isFunction(a.up)||(a.up=0),b.isFunction(a.down)||(a.down=0),a.offsetLeft=Number(a.offsetLeft)||0,a.offsetTop=Number(a.offsetTop)||0,d=[],this.each(function(){var e=b(this),f=j(e,a),g={},h={};a.pc&&(g.mousedown=f.touchstart,h.mousemove=f.touchmove,h.mouseup=f.touchend),a.mobile&&(g.touchstart=f.touchstart,h.touchmove=f.touchmove,h.touchend=f.touchend,h.touchcancel=f.touchend),e.bind(g),c.bind(h),d.push(f)}),e=new m(d)}})}(document,MingGe);